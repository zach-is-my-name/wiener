{"version":3,"file":"convert.js","names":["addNewsletterToDb","loadNewsletterFromDb","applyMarkdown","getDateFromNewsletter","validateInputDate","dayjs","customParseFormat","extend","convertAndStore","htmlNewsletter","url","prevUrl","nextUrl","newsletter","markdown","date","split","res"],"sources":["../../src/transform/convert.js"],"sourcesContent":["import {addNewsletterToDb, loadNewsletterFromDb} from '../db/db.js'\nimport {applyMarkdown} from './applyMarkdown.js'\nimport {getDateFromNewsletter, validateInputDate} from '../utilities.js'\nimport dayjs from 'dayjs'\nimport customParseFormat from 'dayjs/plugin/customParseFormat.js'\ndayjs.extend(customParseFormat)\n\nexport async function convertAndStore(htmlNewsletter, url, prevUrl, nextUrl) {\n  \n  let {markdown: newsletter}  = await applyMarkdown(htmlNewsletter)\n  const date = await getDateFromNewsletter(newsletter) \n\n  await validateInputDate(date) \n\n  newsletter = newsletter.split(/\\n/) \n  \n  debugger;\n  const res = await addNewsletterToDb(date, newsletter, url, prevUrl, nextUrl) \n  // if (!res) return new Error({date, newsletter, url, prevUrl, nextUrl})\n  return res\n}\n\n\n\n\n\n\n\n\n"],"mappings":";;AAAA,SAAQA,iBAAiB,EAAEC,oBAAoB,QAAO,aAAa;AACnE,SAAQC,aAAa,QAAO,oBAAoB;AAChD,SAAQC,qBAAqB,EAAEC,iBAAiB,QAAO,iBAAiB;AACxE,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,iBAAiB,MAAM,mCAAmC;AACjED,KAAK,CAACE,MAAM,CAACD,iBAAiB,CAAC;AAE/B,gBAAsBE,eAAe;EAAA;AAAA;AAapC;EAAA,4EAbM,iBAA+BC,cAAc,EAAEC,GAAG,EAAEC,OAAO,EAAEC,OAAO;IAAA;IAAA;MAAA;QAAA;UAAA;UAAA,OAErCV,aAAa,CAACO,cAAc,CAAC;QAAA;UAAA;UAAlDI,UAAU,wBAApBC,QAAQ;UAAA;UAAA,OACMX,qBAAqB,CAACU,UAAU,CAAC;QAAA;UAA9CE,IAAI;UAAA;UAAA,OAEJX,iBAAiB,CAACW,IAAI,CAAC;QAAA;UAE7BF,UAAU,GAAGA,UAAU,CAACG,KAAK,CAAC,IAAI,CAAC;UAEnC;UAAS;UAAA,OACShB,iBAAiB,CAACe,IAAI,EAAEF,UAAU,EAAEH,GAAG,EAAEC,OAAO,EAAEC,OAAO,CAAC;QAAA;UAAtEK,GAAG;UAAA,iCAEFA,GAAG;QAAA;QAAA;UAAA;MAAA;IAAA;EAAA,CACX;EAAA;AAAA"}