{"version":3,"file":"utilities.js","names":["dayjs","customParseFormat","duration","extend","cheerio","got","pThrottle","fetchDateCurrent","text","data","getDate","dateNumberFormat","dateWordFormat","fetchPermaLinkCurrent","console","clear","trace","$","load","children","attr","validateInputDate","date","isValid","getUrlOfNewsletter","markdownNewsletter","re","execResult","exec","document","match","monthName","day","year","monthNum","monthNameToNumber","toLowerCase","getDateFromNewsletter","newsletter","throttle","limit","interval","throttledGot","url","parseDate","strDate","length","test","_strDate","replace","parseInt"],"sources":["../src/utilities.js"],"sourcesContent":["import dayjs from 'dayjs'\nimport customParseFormat from 'dayjs/plugin/customParseFormat.js'\nimport duration from 'dayjs/plugin/duration.js'\ndayjs.extend(duration)\ndayjs.extend(customParseFormat)\nimport cheerio from 'cheerio'\nimport got from 'got';\nimport pThrottle from 'p-throttle';\n\nexport async function fetchDateCurrent() {\n  let data \n  try {\n    data = await got('https://weekinethereumnews.com').text();\n  } catch (error) {\n    return \n  }\n  const { dateNumberFormat, dateWordFormat } = await getDate(data)  \n  return ({ dateNumberFormat, dateWordFormat })\n}\n\nexport async function fetchPermaLinkCurrent() {\n  let data \n  try {\n    data =  await got('https://weekinethereumnews.com').text();\n  } catch (error) {\n    console.clear()\n    console.trace() \n    return \n  }\n  const $ = cheerio.load(data)\n  return $('h2.entry-title').children('a').attr('href')\n}\n\nexport async function validateInputDate(date) {\n\n  if (typeof date !== 'string') {\n    // new Error(`argument must be a string ${JSON.stringify(date)}`)\n    return \n  } else if (dayjs(date, 'M-D-YYYY').isValid() === false){ \n    // new Error(`date format invalid ${date}`)\n    return \n  }\n}\n\nexport function getUrlOfNewsletter(markdownNewsletter) {\n  validateInputDate(markdownNewsletter)\n  const re = /(https\\:\\/\\/weekinethereumnews.com\\/(?:week-in-eth(?:ereum)?-news-)?.*\\d)/igm\n\n  const execResult = re.exec(markdownNewsletter)\n  return execResult[1]+'/'\n}\n\n//searches rendered text\nasync function getDate(document) {\n  const re = /(Jan(?:uary)?|Feb(?:ruary)?|Mar(?:ch)?|Apr(?:il)?|May|Jun(?:e)?|Jul(?:y)?|Aug(?:ust)?|Sep(?:tember)?|Oct(?:ober)?|Nov(?:ember)?|Dec(?:ember)?)\\s+(\\d{1,2}),\\s+(\\d{4})/i\n\n  try {\n    const execResult = re.exec(document)   \n    const [match, monthName, day, year] = execResult\n    let monthNum = monthNameToNumber(monthName)\n    return ({dateWordFormat:`${monthName.toLowerCase()}-${day}-${year}/`, dateNumberFormat: monthNum + '-' + day + '-'+ year})\n  } catch(error) {\n    // new Error(error)\n  }\n}\n\nexport async function getDateFromNewsletter(newsletter) {\n  const {dateNumberFormat: date} = await getDate(newsletter)\n  validateInputDate(date)\n  return date\n}\n\nexport function monthNameToNumber(monthName){ if (typeof monthName === 'number') {\n  return monthName\n}\nswitch (monthName) {\n  case  \"January\": \n  case \"january\":\n  case    \"Jan\":\n  case  \"jan\":\n    return \"1\"\n    break;\n  case  \"February\":\n  case  \"february\":\n  case  \"Feb\":\n  case \"feb\": \n    return \"2\" \n    break;\n  case  \"March\":\n  case  \"march\":\n  case  \"Mar\": \n  case  \"mar\": \n    return \"3\"\n    break;\n  case  \"April\":\n  case  \"april\":\n  case \"Apr\":\n  case \"apr\":\n    return \"4\"\n    break;\n  case  \"May\":\n  case  \"may\":\n  case \"may\" :\n    return \"5\" \n    break;\n  case  \"June\":\n  case  \"june\":\n  case \"Jun\":  \n  case \"jun\":\n    return \"6\"\n    break;\n  case  \"July\":\n  case  \"july\":\n  case  \"Jul\":  \n  case  \"jul\":\n    return \"7\" \n    break;\n  case  \"August\":\n  case  \"august\":\n  case \"Aug\":\n  case \"aug\":\n    return \"8\" \n    break;\n  case  \"September\":  \n  case  \"september\":  \n  case \"Sept\":\n  case\"sept\":\n    return \"9\" \n    break;\n  case\"October\":\n  case\"october\":\n  case \"Oct\" :\n  case \"oct\":\n    return \"10\" \n    break;\n  case  \"November\":\n  case  \"november\":\n  case \"Nov\":  \n  case \"nov\":\n    return \"11\"\n    break;\n  case  \"December\":\n  case  \"december\":\n  case\"Dec\": \n  case \"dec\":\n    return \"12\" \n    break;\n}\n}\n\nconst throttle = pThrottle({\n  limit: 2,\n  interval: 5000\n});\n\nexport const throttledGot = throttle( async url => {\n  return got(url).text()  \n})\n\nexport function parseDate(strDate) {\n  if (strDate?.length && (/(\\d+)-(\\d+)-(\\d+)/).test(strDate)) {\n    let _strDate = strDate.replace(/(\\d+)-(\\d+)-(\\d+)/, \"$1+$2+$3\")\n    return parseInt(_strDate)\n  }         \n  return false\n}\n\n"],"mappings":"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"}