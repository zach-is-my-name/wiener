{"version":3,"file":"useKeyHandler.js","names":["blessed","ansiRegex","stripAnsi","open","useKeyHandler","refs","state","dispatch","ctrDispatch","mainBoxRef","scrollToScrollHeightFlagRef","cursorTop","cursorLeft","keyHandler","ch","key","nextCursorPosition","nextTenXCursorPosition","nextTwentyYCursorPosition","updateCoordinate","input","type","payload","current","getScrollHeight","scrollTo","width","scrollToScrollHeightFlag","getScreenLines","length","setScrollPerc","position","height","setCursorTop","setCursorLeft","forward","maxLength","adjustment","full","process","exit","activateLinkBox","includes","activateRefBox","initialRefNum","lines","before","slice","cursorIndex","stripTags","join","cursorLine","text","re","match","exec","start","index","end","openLinkIndex","parseInt","line","followLinkUnderCursor","regexLink"],"sources":["../../../../src/ui/customHooks/ui/useKeyHandler.js"],"sourcesContent":["import blessed from 'blessed';\nimport ansiRegex from 'ansi-regex';\nimport stripAnsi from 'strip-ansi'\nimport open from 'open'\n\nexport function useKeyHandler(refs, state, dispatch, ctrDispatch) {\n  const {mainBoxRef, scrollToScrollHeightFlagRef} = refs\n  const {cursorTop, cursorLeft} = state \n\n  async function keyHandler(ch, key) {\n    if (key.full === 'q' || key.full === 'C-c') {\n      return process.exit(0);\n    } else if (key.full === 'enter') {\n      await activateLinkBox()     //followLinkUnderCursor()\n    } else if ([\"1\" , \"2\" , \"3\" , \"4\" , \"5\" , \"6\" , \"7\" , \"8\" , \"9\"].includes(key.full)) {\n      await activateRefBox(key.full)\n    } else {\n      updateCoordinate(key.full)\n    }\n\n    function nextCursorPosition( current, forward, maxLength, adjustment )  {\n      let position = current + (forward ? 1 : -1)\n\n      position = position < 0 ? 0 : position\n      position = position > maxLength - adjustment ? maxLength - adjustment : position\n\n      return position\n    }\n\n    function nextTenXCursorPosition( current, forward, maxLength, adjustment )  {\n      let position = current + (forward ? 10 : -10)\n      position = position < 0 ? 0 : position\n      position =\n        position > maxLength - adjustment ? maxLength - adjustment : position\n\n      return position\n    }\n\n    function nextTwentyYCursorPosition( current, forward, maxLength, adjustment )  { \n      let position = current + (forward ? 10 : -10)\n      position = position < 0 ? 0 : position\n      position =\n        position > maxLength - adjustment ? maxLength - adjustment : position\n\n      return position\n    }\n\n    function updateCoordinate(input)  {\n      if (input === 'j' || input === 'k' || input === 'down' || input === 'up') {\n        dispatch({type: \"setCursorTop\", payload: nextCursorPosition(\n          cursorTop,\n          input === 'j' || input === 'down',\n          mainBoxRef?.current?.getScrollHeight(),\n          1,\n        )})\n        mainBoxRef.current?.scrollTo(cursorTop)\n\n      } else if (input === 'h' || input === 'l' || input === 'left' || input ==='right') {\n        dispatch({type:\"setCursorLeft\", payload: nextCursorPosition(\n          cursorLeft,\n          input === 'l' || input === 'right',\n          mainBoxRef.current?.width,\n          3,\n        )})\n      } else if (input === 'escape') {\n        ctrDispatch({type: \"exitHelpPage\"})\n      } else if (input === 'S-h') {\n        ctrDispatch({type: \"loadPrevHook\"})\n      } else if (input === 'S-l') {\n        ctrDispatch({type: \"loadNextHook\"})\n      } else if  (input === 'w' || input === 'b') {\n        dispatch({type:\"setCursorLeft\", payload: nextTenXCursorPosition(\n          cursorLeft,\n          input === 'w',\n          mainBoxRef.current?.width,\n          9,\n        )})\n      } else if (input === 'S-s') {\n          ctrDispatch({type: \"toggleRenderSearch\"})\n      } else if (input === '{' || input === '}') {\n        dispatch({type: \"setCursorTop\", payload: nextTwentyYCursorPosition(\n          cursorTop,\n          input === '}',\n          mainBoxRef.current?.getScrollHeight(),\n          9,\n        )})\n\n      }  else if (input === 'g' || input === 'home') {\n        dispatch({type:\"setCursorTop\", payload:0}) \n        mainBoxRef.current?.scrollTo(cursorTop)\n        if (cursorTop > mainBoxRef.current.getScrollHeight()) {\n          scrollToScrollHeightFlag.current = true;\n        } \n\n      } else if (input === 'S-g' || input === 'end') {\n        dispatch({type:\"setCursorTop\", payload: mainBoxRef.current.getScreenLines().length - 1})\n        mainBoxRef.current?.scrollTo(cursorTop)\n\n      } else if (input === '0') {\n        dispatch({type:\"setCursorLeft\", payload: 0})\n        \n      } else if (input === '$') {\n        dispatch({type:\"setCursorLeft\", payload: mainBoxRef.current?.width - 1})\n\n      } else if (input === \"x\") {\n        mainBoxRef.current?.setScrollPerc(100)\n      } else if (input === 'backspace') {\n          ctrDispatch({type: \"gotoLatestInArchive\"})\n      } else if (input === 'C-d' || input === 'd' || input === 'D' || input === 'pagedown' || input === 'S-d') {\n\n        let position = cursorTop + mainBoxRef?.current?.height \n        position = position >= mainBoxRef?.current?.getScrollHeight() ? mainBoxRef?.current?.getScrollHeight() - 1 : position  \n\n        dispatch({type: \"setCursorTop\", payload: position })\n\n      } else if (input === 'C-u' || input ==='u' || input === 'U' || input === 'pageup' || input === 'S-u') {\n        let position = cursorTop - mainBoxRef?.current?.height - 2 \n        position = position < 0 ? 0 : position\n        dispatch({type:\"setCursorTop\", payload: position})\n        \n      } else if (input === 'S-g') {\n        setCursorTop(mainBoxRef.current?.getScreenLines().length - 1)\n        mainBoxRef.current?.scrollTo(cursorTop)\n        setCursorLeft(0)\n      } else if (input === '?') {\n        ctrDispatch({type: \"toggleHelpPage\"})\n      }\n    }\n  }\n\n  function activateRefBox(initialRefNum) {\n    dispatch({type: \"openRefBox\", payload: initialRefNum})\n  }\n\n  async function activateLinkBox() {\n    const lines = mainBoxRef.current?.getScreenLines()\n    const before = lines?.slice(0, cursorTop)\n    const cursorIndex = blessed.stripTags(before?.join('')).length + cursorLeft\n    const cursorLine = lines[cursorTop]\n    if (cursorLeft <= cursorLine.length) {\n      const text = blessed.stripTags(lines.join(''))\n      const re = /\\[(\\d+)\\]/g\n      let match = re.exec(text)\n      while (match) {\n        const start = match.index\n        const end = start + match[0].length\n        \n        if (start <= cursorIndex && cursorIndex < end) {\n          let openLinkIndex = match[1]\n          openLinkIndex = stripAnsi(openLinkIndex)\n          openLinkIndex = parseInt(openLinkIndex, 10)\n          dispatch({type: \"openLinkBox\", payload: {openLinkIndex, line: cursorTop}  })\n          break\n        }\n\n        match = re.exec(text)\n\n      }\n    }\n  }\n\n  function followLinkUnderCursor()  {\n    const regexLink = /(https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b[-a-zA-Z0-9()@:%_\\+.~#?&//=]*)/gm\n    // check if the chunk under the cursor is a markdown link\n    const lines = mainBoxRef?.current.getScreenLines()\n    if (cursorTop > lines?.length) {\n      return\n    }\n    const before = lines?.slice(0, cursorTop)\n    const cursorIndex = blessed.stripTags(before?.join('')).length + cursorLeft\n    const cursorLine = blessed.stripTags(lines[cursorTop])\n\n    if (cursorLeft <= cursorLine.length) {\n      const text = blessed.stripTags(lines.join(''))\n      let match = regexLink.exec(text)\n      while (match) {\n        const start = match.index\n        const end = start + match[0].length\n\n        if (start <= cursorIndex && cursorIndex < end) {\n          open(match[1])\n          break\n        }\n\n        match = regexLink.exec(text)\n      }\n      dispatch({type: \"toggleWasMouseClicked\"})\n    }\n  }\n  return [{followLinkUnderCursor, keyHandler}] \n}\n\n\n"],"mappings":"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"}