{"version":3,"file":"useHasLatestInArchive.js","names":["React","useEffect","useState","getDateLatestInArchive","fetchDateCurrent","parseDate","getArchiveLength","useHasLatestInArchive","hasInternet","loadState","hasLatestInArchive","setHasLatestInArchive","dateLatestPub","setDateLatestPub","dateNumberFormat","setDateNumberFormat","dateWordFormat","setDateWordFormat","archiveLength","setArchiveLength","latestArchiveDate","Array","isArray","length","parsedLatestArchiveDate","parsedDateNumberFormat","hasLatestBool","Boolean"],"sources":["../../../src/ui/customHooks/useHasLatestInArchive.js"],"sourcesContent":["import React, {useEffect, useState} from 'react'\nimport {getDateLatestInArchive} from '../../db/db.js' \nimport {fetchDateCurrent, parseDate} from '../../utilities.js'\n\nimport {getArchiveLength} from '../../db/db.js'\n\nexport function useHasLatestInArchive(hasInternet, loadState) {\n  const [hasLatestInArchive, setHasLatestInArchive] = useState(\"loading\") \n  const [dateLatestPub, setDateLatestPub] = useState(null) \n  const [dateNumberFormat, setDateNumberFormat] = useState(null)\n  const [dateWordFormat, setDateWordFormat] = useState(null)\n  const [archiveLength, setArchiveLength] = useState(null)\n\n  useEffect(() => {\n    (async () => {\n      const { dateWordFormat, dateNumberFormat} = await fetchDateCurrent()\n      setDateWordFormat(dateWordFormat)\n      setDateNumberFormat(dateNumberFormat)  \n      setDateLatestPub(dateNumberFormat)\n    })();\n  }, [dateNumberFormat, dateWordFormat])\n\n  useEffect(() => {\n    if (hasLatestInArchive !== true) {\n      (async () => {\n        setArchiveLength(await getArchiveLength())\n      })();\n    }\n  }, [loadState])\n\n  useEffect(()=> {\n    if (hasLatestInArchive !== true && hasInternet === true ) {\n      (async () => {\n        const latestArchiveDate = await getDateLatestInArchive();\n\n        if (Array.isArray(latestArchiveDate) && latestArchiveDate.length === 0) setHasLatestInArchive(false)\n        let parsedLatestArchiveDate = parseDate(latestArchiveDate)\n        let parsedDateNumberFormat = parseDate(dateNumberFormat)\n\n        if (parsedLatestArchiveDate && parsedDateNumberFormat) {\n          let hasLatestBool = Boolean(dateNumberFormat === latestArchiveDate)\n          setHasLatestInArchive(hasLatestBool)\n        } \n        \n      })()\n    }\n  }, [hasInternet, dateNumberFormat, hasLatestInArchive, archiveLength])\n\n  return {hasLatestInArchive, dateLatestPub} \n}\n\n"],"mappings":";;;AAAA,OAAOA,KAAK,IAAGC,SAAS,EAAEC,QAAQ,QAAO,OAAO;AAChD,SAAQC,sBAAsB,QAAO,gBAAgB;AACrD,SAAQC,gBAAgB,EAAEC,SAAS,QAAO,oBAAoB;AAE9D,SAAQC,gBAAgB,QAAO,gBAAgB;AAE/C,OAAO,SAASC,qBAAqB,CAACC,WAAW,EAAEC,SAAS,EAAE;EAC5D,gBAAoDP,QAAQ,CAAC,SAAS,CAAC;IAAA;IAAhEQ,kBAAkB;IAAEC,qBAAqB;EAChD,iBAA0CT,QAAQ,CAAC,IAAI,CAAC;IAAA;IAAjDU,aAAa;IAAEC,gBAAgB;EACtC,iBAAgDX,QAAQ,CAAC,IAAI,CAAC;IAAA;IAAvDY,gBAAgB;IAAEC,mBAAmB;EAC5C,iBAA4Cb,QAAQ,CAAC,IAAI,CAAC;IAAA;IAAnDc,cAAc;IAAEC,iBAAiB;EACxC,iBAA0Cf,QAAQ,CAAC,IAAI,CAAC;IAAA;IAAjDgB,aAAa;IAAEC,gBAAgB;EAEtClB,SAAS,CAAC,YAAM;IACd,yDAAC;MAAA;MAAA;QAAA;UAAA;YAAA;YAAA,OACmDG,gBAAgB,EAAE;UAAA;YAAA;YAA5DY,cAAc,yBAAdA,cAAc;YAAEF,gBAAgB,yBAAhBA,gBAAgB;YACxCG,iBAAiB,CAACD,cAAc,CAAC;YACjCD,mBAAmB,CAACD,gBAAgB,CAAC;YACrCD,gBAAgB,CAACC,gBAAgB,CAAC;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA,CACnC,IAAG;EACN,CAAC,EAAE,CAACA,gBAAgB,EAAEE,cAAc,CAAC,CAAC;EAEtCf,SAAS,CAAC,YAAM;IACd,IAAIS,kBAAkB,KAAK,IAAI,EAAE;MAC/B,yDAAC;QAAA;UAAA;YAAA;cAAA,eACCS,gBAAgB;cAAA;cAAA,OAAOb,gBAAgB,EAAE;YAAA;cAAA;cAAA;YAAA;YAAA;cAAA;UAAA;QAAA;MAAA,CAC1C,IAAG;IACN;EACF,CAAC,EAAE,CAACG,SAAS,CAAC,CAAC;EAEfR,SAAS,CAAC,YAAK;IACb,IAAIS,kBAAkB,KAAK,IAAI,IAAIF,WAAW,KAAK,IAAI,EAAG;MACxD,yDAAC;QAAA;QAAA;UAAA;YAAA;cAAA;cAAA,OACiCL,sBAAsB,EAAE;YAAA;cAAlDiB,iBAAiB;cAEvB,IAAIC,KAAK,CAACC,OAAO,CAACF,iBAAiB,CAAC,IAAIA,iBAAiB,CAACG,MAAM,KAAK,CAAC,EAAEZ,qBAAqB,CAAC,KAAK,CAAC;cAChGa,uBAAuB,GAAGnB,SAAS,CAACe,iBAAiB,CAAC;cACtDK,sBAAsB,GAAGpB,SAAS,CAACS,gBAAgB,CAAC;cAExD,IAAIU,uBAAuB,IAAIC,sBAAsB,EAAE;gBACjDC,aAAa,GAAGC,OAAO,CAACb,gBAAgB,KAAKM,iBAAiB,CAAC;gBACnET,qBAAqB,CAACe,aAAa,CAAC;cACtC;YAAC;YAAA;cAAA;UAAA;QAAA;MAAA,CAEF,IAAG;IACN;EACF,CAAC,EAAE,CAAClB,WAAW,EAAEM,gBAAgB,EAAEJ,kBAAkB,EAAEQ,aAAa,CAAC,CAAC;EAEtE,OAAO;IAACR,kBAAkB,EAAlBA,kBAAkB;IAAEE,aAAa,EAAbA;EAAa,CAAC;AAC5C"}