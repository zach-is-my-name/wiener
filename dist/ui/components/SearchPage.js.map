{"version":3,"file":"SearchPage.js","names":["React","useLayoutEffect","useEffect","useState","useRef","useSearchWien","SearchPage","searchPageHidden","setDateFromSearch","setLineFromSearch","ctrDispatch","isMounted","textBoxRef","listRef","query","setQuery","items","setItems","dateIndex","setDateIndex","focus","setFocus","current","pick","handleKeyPressTextbox","ch","key","setImmediate","name","full","process","exit","value","type","handleSelect","item","index","length","res","find","obj","date","line","border","fg","selected","bg"],"sources":["../../../src/ui/components/SearchPage.js"],"sourcesContent":["import React, {useLayoutEffect, useEffect, useState, useRef} from 'react'\nimport {useSearchWien} from '../customHooks/useSearchWien.js' \n\nfunction SearchPage({searchPageHidden, setDateFromSearch, setLineFromSearch, ctrDispatch} ) {\n  const isMounted = useRef(false)\n  const textBoxRef = useRef(null) \n  const listRef = useRef(null)\n\n  const [query, setQuery] = useState(\"\")\n  const [items, setItems] = useState([])\n  const [dateIndex, setDateIndex] = useState([])\n  const [focus, setFocus] = useState('textBox')\n\n  useEffect(() => {\n    isMounted.current = true;\n    return () => {\n      isMounted.current = false;\n    }\n  }, [])\n\n  useEffect(()=> {\n    if (focus === 'textBox' && !searchPageHidden) {\n      textBoxRef.current.focus()\n    } else if (focus === 'list' && !searchPageHidden) {\n      listRef.current.pick(()=>{})\n    } \n  }, [focus, searchPageHidden])\n\n  const handleKeyPressTextbox = (ch, key) => {\n    setImmediate(() => {\n      if (key.name === 'enter') {\n        setFocus(\"list\")\n      } else if (key.full === 'C-c') {\n        process.exit(0)\n      } \n      else if (isMounted.current === true) { \n        useSearchWien(textBoxRef.current.value, setItems, setDateIndex, ctrDispatch, isMounted)\n      }\n      if (key.name === 'escape'){\n        ctrDispatch({type: \"exitSearchPage\"})  \n      }\n    })\n  }\n\n  const handleSelect = (item, index) => {\n    if (items.length) {\n      const res = dateIndex.find(obj => obj.index === index) \n      const {date, line} = res\n      setDateFromSearch(date)\n      setLineFromSearch(line)\n      ctrDispatch({type: \"loadFromSearch\"})\n      ctrDispatch({type:\"toggleRenderSearch\"})\n    }\n  }\n\n  return (\n    <form\n    onReset={() => ctrDispatch({type:\"toggleRenderSearch\"})}\n    left=\"1%\"\n    top=\"5%\"\n    width=\"99%\"\n    hidden={searchPageHidden}\n    height=\"99%\"\n    name={\"form_\"}\n    >\n    <box     \n    top={\"5%\"}\n    width={\"80%\"}\n    height={3}\n    left={\"center\"}\n    border={{type: 'line'}}\n    style={{border: {fg: 'white'}}}\n    >\n    Search:\n    <textbox\n    ref={textBoxRef}\n    top={\"5%\"}\n    left={\"10%\"}\n    width={\"70%\"}\n    onKeypress={handleKeyPressTextbox}\n    inputOnFocus\n    keys\n    mouse\n    name={\"thin-textBox\"}\n    />\n    </box> \n\n    <list \n    height={\"85%\"}\n    top={\"13%\"}\n    width={\"80%\"}\n    left={\"center\"}\n    onKeypress={(ch, key)=> {if (key === 'escape') {ctrDispatch({type:\"exitSearchPage\"})} else if (key.full ==='C-c') {process.exit(0)}}}\n    items={items}\n    onSelect={handleSelect}\n    onCancel={() => ctrDispatch({type:\"exitSearchPage\"})}\n    keys\n    vi\n    name={\"list\"}\n    border={{type: 'line'}}\n    style={{selected:{fg:'black',bg:'yellow' },border:{fg: 'white'}}}\n    ref={listRef}\n    /> \n    </form>\n\n  )\n}\n\n\nexport default SearchPage\n\n"],"mappings":"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"}