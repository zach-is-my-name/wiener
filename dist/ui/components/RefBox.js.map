{"version":3,"file":"RefBox.js","names":["React","useEffect","useState","useRef","open","RefBox","initialRefNum","dispatch","linkArray","mainBoxRef","hidden","formRef","textAreaRef","refNum","setRefNum","current","setValue","cancelPress","type","openPress","linkIndex","parseInt","linkUrl","handleKeyPressRefBox","ch","key","setImmediate","full","name","includes","focus","height","bg","fg"],"sources":["../../../src/ui/components/RefBox.js"],"sourcesContent":["import React, {useEffect, useState, useRef} from 'react';\nimport open from 'open' \n\nfunction RefBox({initialRefNum, dispatch, linkArray, mainBoxRef, hidden}) {\n  const formRef = useRef(null)\n  const textAreaRef = useRef(null)\n  const [refNum, setRefNum] = useState(initialRefNum)\n\n  useEffect(() => {\n    textAreaRef.current?.setValue(refNum) \n  }, [refNum])\n\n  const cancelPress = () => {\n    dispatch({type: \"closeRefBox\"})  \n  }\n  const openPress = () => {\n    const linkIndex = parseInt(refNum, 10)\n    if (typeof linkIndex === 'number') {\n      const linkUrl = linkArray[linkIndex]\n      open(linkUrl)\n      dispatch({type: \"closeRefBox\"})  \n    } else {\n      dispatch({type: \"closeRefBox\"})  \n    }\n  }\n\n  const handleKeyPressRefBox = (ch, key) => {\n    setImmediate(() => {\n      if (key.full === 'escape') {\n        dispatch({type: \"closeRefBox\"})  \n      }\n      if (key.name === 'escape' || key.name === 'c' || key.name === 'C'){\n        cancelPress() \n      }\n      if ([\"0\",\"1\" , \"2\" , \"3\" , \"4\" , \"5\" , \"6\" , \"7\" , \"8\" , \"9\"].includes(key.full)) {\n        setRefNum(refNum + key.full) \n      } else if (key.name === 'enter') {\n        openPress()\n      }\n    })\n  }\n\n  useEffect(() => {\n    if (!hidden) {\n      formRef.current?.focus()\n      formRef.current?.key('escape', function(ch, key) {\n        cancelPress()\n      })\n      formRef.current?.key('o', function(ch, key) {\n      })\n\n      formRef.current?.key('O', function(ch, key) {\n      })\n    }\n  }, [])\n\n  return(\n    <> \n    <form \n    left={\"left\"} \n    top={mainBoxRef.current?.height -1} \n    onKeypress={handleKeyPressRefBox} \n    hidden={hidden} \n    ref={formRef} \n    align={\"left\"} \n    onSubmit={() => openPress()} \n    onCancel={()=> cancelPress()}\n    content={\"Enter link #:\"}\n    height={1}\n    style={{bg: \"blue\", fg: \"white\"}}\n    >\n    <textarea ref={textAreaRef} width={4} style={{bg: \"blue\", fg: \"white\"}} left={15} content={initialRefNum} / > \n    </form>\n\n    </>\n\n\n  )\n}\nexport default RefBox\n\n\n"],"mappings":"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"}